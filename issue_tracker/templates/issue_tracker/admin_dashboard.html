{% extends 'issue_tracker/base.html' %}
{% load static %}

{% block content %}
<div class="row">
	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="open-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Open Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{open_tickets}}</h3>
			  	</div>
			</div>
		</div>
	</div>

	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="pending-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Pending Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{pending_tickets}}</h3>
			  	</div>
			</div>
		</div>
	</div>

	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="critical-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Critical Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{ critical_sum }}</h3>
			  	</div>
			</div>
		</div>
	</div>
</div>

<br>

<div class="row">
	<div class="col-md-4">
		<h5>COMMENTS:</h5>
		<hr>
		<div class="card card-body">
			<a class="btn btn-primary  btn-sm btn-block" href="{% url 'issue_tracker:home' %}">All Tickets</a>
			<table class="table table-sm">
				<tr>
					<th></th>
					<th>Comments</th>
				</tr>

				{% for comment in page_obj %}
					<tr>
						<td><a class="btn btn-sm btn-danger" href="#">Delete</a></td>
						<td>{{comment.comment_text}}</td>
					</tr>
				{% endfor %}

			</table>
		</div>
	</div>

	<div class="col-md-8">
		<h5>TICKETS:</h5>
		<hr>
		<div class="card card-body">
			<a class="btn btn-primary  btn-sm btn-block" href="{% url 'issue_tracker:create_ticket' %}">Create Ticket</a>
			<table class="table table-sm">
				<tr>
					<th>Title</th>
					<th>Ticket Choice</th>
					<th>Priority</th>
					<th>Status</th>
					<th>Add/Update</th>
					<th>Remove</th>
				</tr>

				{% for admin in admin_tickets %}

					<tr>

						<td>{{admin.admin_ticket.title|truncatewords:25}}</td>
						<td>{{admin.admin_ticket.ticket_choice}}</td>
						<td>{{admin.priority_choice}}</td>
						<td>{{ admin.status_choice }}</td>

						<td><a class="btn btn-sm btn-info" href="{% url 'issue_tracker:add_admin_ticket' admin.id %}">Add</a></td>

						<td><a class="btn btn-sm btn-danger" href="{% url 'issue_tracker:delete_ticket' admin.id %}">Delete</a></td>

					</tr>

				{% endfor %}
			</table>
		</div>
	</div>

</div>

<!--Pagination for 10 per page -->
<div class="pagination">
	<span class="step-links">
		{% if page_obj.has_previous %}
				<a href="?page=1">&laquo; first</a>
				<a href="?page={{ page_obj.previous_page_number }}">previous</a>
		{% endif %}

		<span class="current">
				Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
		</span>

		{% if page_obj.has_next %}
				<a href="?page={{ page_obj.next_page_number }}">next</a>
				<a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
		{% endif %}
	</span>
</div>
</div>


{% endblock content %}
