{% extends 'issue_tracker/base.html' %}
{% load static %}

{% block content %}
<div class="row">
	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="open-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Open Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{open_tickets}}</h3>
			  	</div>
			</div>
		</div>
	</div>

	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="pending-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Pending Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{pending_tickets}}</h3>
			  	</div>
			</div>
		</div>
	</div>

	<div class="col">
		<div class="col-md">
			<div class="card text-center text-white  mb-3" id="critical-tickets">
			  	<div class="card-header">
			  		<h5 class="card-title">Critical Tickets</h5>
			  	</div>
			  	<div class="card-body">
			    	<h3 class="card-title">{{ critical_sum }}</h3>
			  	</div>
			</div>
		</div>
	</div>
</div>

<br>

<div class="row">
	<div class="col-md-4">
		<h5>COMMENTS:</h5>
		<hr>
		<div class="card card-body">
			<a class="btn btn-primary  btn-sm btn-block" href="{% url 'issue_tracker:home' %}">All Tickets</a>
			<table class="table table-sm">
				<tr>
					<th></th>
					<th>Comments</th>
				</tr>

				{% for comment in page_obj %}
					<tr>
						<td>
							<form action="{% url 'issue_tracker:delete_comment' comment.id %}" method='post'>
							{% csrf_token %}
							<button type='submit' class="btn btn-danger">Delete</button>
						</td>
						<td>{{comment.comment_text}}</td>
					</tr>
				{% endfor %}

			</table>
		</div>
	</div>

	<div class="col-md-8">
		<h5>TICKETS:</h5>
		<hr>
		<div class="card card-body">
			<a class="btn btn-primary  btn-sm btn-block" href="{% url 'issue_tracker:create_ticket' %}">Create Ticket</a>
			<table class="table table-sm">
				<tr>
					<th>Title</th>
					<th>Ticket Choice</th>
					<th>Priority</th>
					<th>Status</th>
					<th>Add/Update</th>
					<th>Remove</th>
				</tr>

				{% for ticket in page_objs %}

					<tr>

						<td>{{ticket.title|truncatewords:'25'}}</td>
						<td>{{ticket.ticket_choice}}</td>
						<td>{{ticket.admin.priority_choice}}</td>
						<td>{{ ticket.admin.status_choice }}</td>

						<td><a class="btn btn-sm btn-info" href="/edit_admin_ticket/{{ticket.id}}/{{ticket.admin.id}}/">Update</a></td>

						<td><a class="btn btn-sm btn-danger" href="{% url 'issue_tracker:delete_ticket' ticket.id %}">Delete</a></td>

					</tr>

				{% endfor %}
			</table>
		</div>
	</div>

</div>

<!--Pagination for 10 per page for comments -->
<div class="row">
	<div class="col-md-4">


		<div class="pagination">
			<span class="step-links">
				{% if page_obj.has_previous %}
						<a href="?page=1">&laquo; first</a>
						<a href="?page={{ page_obj.previous_page_number }}">previous</a>
				{% endif %}

				<span class="current">
						Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
				</span>

				{% if page_obj.has_next %}
						<a href="?page={{ page_obj.next_page_number }}">next</a>
						<a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
				{% endif %}
			</span>
		</div>
	</div>

<!--Pagination for 10 per page for tickets -->
	<div class="col-md-8">
		<div class="pagination">

			<span class="step-links">
				{% if page_objs.has_previous %}
						<a href="?page1=1">&laquo; first</a>
						<a href="?page1={{ page_objs.previous_page_number1 }}">previous</a>
				{% endif %}

				<span class="current">
						Page {{ page_objs.number }} of {{ page_objs.paginator.num_pages }}.
				</span>

				{% if page_objs.has_next %}
						<a href="?page1={{ page_objs.next_page_number }}">next</a>
						<a href="?page1={{ page_objs.paginator.num_pages }}">last &raquo;</a>
				{% endif %}
			</span>
		</div>
	</div>
</div>


{% endblock content %}
